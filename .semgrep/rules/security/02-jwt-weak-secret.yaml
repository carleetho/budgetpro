rules:
  - id: 02-jwt-weak-secret
    patterns:
      - pattern-either:
          - pattern: $T $JWT_SECRET = "$VALUE";
          - pattern: $JWT_SECRET = "$VALUE";
      - metavariable-regex:
          metavariable: $JWT_SECRET
          regex: (?i).*(jwt|secret).*
      - metavariable-regex:
          metavariable: $VALUE
          # Detect string contents with length < 32
          regex: ^.{0,31}$
    message: |
      JWT secret is too weak (length < 32 characters).
      A weak JWT secret can be brute-forced easily.
      Ensure the secret is at least 32 characters long for HS256.
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      technology: jwt
      confidence: HIGH
